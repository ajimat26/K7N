<!DOCTYPE html>
<html>
<head>
  <title>UANGDUTY</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      text-align: center;
    }
    .container {
      margin-top: 50px;
    }
    h1 {
      margin-bottom: 20px;
    }
    input, button {
      padding: 10px;
      margin: 5px;
    }
    .green {
      color: green;
      font-weight: bold;
    }
    #admin-panel {
      display: none;
      margin-top: 20px;
      border: 1px solid black;
      padding: 15px;
      background: #fff;
    }
    #admin-mode {
      position: absolute;
      left: 10px;
      top: 10px;
      background-color: red;
      color: white;
      padding: 5px 10px;
      cursor: pointer;
    }
    #admin-indicator {
      margin-top: 5px;
      font-size: 12px;
    }
    .chat {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="admin-mode" onclick="toggleAdminPrompt()">Mode Admin</div>
  <div id="admin-indicator">[Admin: Nonaktif]</div>

  <div class="container">
    <h1>UANGDUTY</h1>

    <div id="buat-akun-section">
      <input id="nama" placeholder="Nama Anda">
      <button onclick="buatAkun()">Buat Akun</button>
    </div>

    <div id="akun-section" style="display:none;">
      <h3 id="akun-nama"></h3>
      <p>Uang Anda: <span id="uang" class="green">0rb</span></p>
      <button onclick="tambahUang()">Tambah Uang</button>
      <button onclick="ambilUang()">Ambil Uang</button>
      <button onclick="resetUang()">Setor (Reset)</button>
    </div>

    <div class="chat">
      <input id="pesan" placeholder="Tulis pesan">
      <button onclick="kirimPesan()">Kirim</button>
      <div id="chatbox"></div>
    </div>

    <div id="admin-panel">
      <h3>Panel Admin</h3>
      <button onclick="toggleAksesBuatAkun()">Akses Buat Akun: <span id="status-akses">Tertutup</span></button>
      <div id="daftar-akun"></div>
    </div>
  </div>

  <script>
    let akun = null;
    let aksesBuatAkun = false;
    let adminMode = false;
    let semuaAkun = [];

    function toggleAdminPrompt() {
      if (adminMode) {
        adminMode = false;
        document.getElementById("admin-panel").style.display = "none";
        document.getElementById("admin-mode").style.background = "red";
        document.getElementById("admin-indicator").innerText = "[Admin: Nonaktif]";
      } else {
        const password = prompt("Masukkan password admin:");
        if (password === "RFD1") {
          adminMode = true;
          document.getElementById("admin-panel").style.display = "block";
          document.getElementById("admin-mode").style.background = "green";
          document.getElementById("admin-indicator").innerText = "[Admin: Aktif]";
          tampilkanDataAdmin();
        } else {
          alert("Password salah.");
        }
      }
    }

    function tampilkanDataAdmin() {
      const panel = document.getElementById("daftar-akun");
      panel.innerHTML = "";
      semuaAkun.forEach((a, i) => {
        const div = document.createElement("div");
        div.innerHTML = `
          ${i+1}. <input value="${a.nama}" onchange="gantiNama(${i}, this.value)"> 
          - <span class='green'>${formatUang(a.uang)}</span> 
          <button onclick="hapusAkun(${i})">Hapus</button>`;
        panel.appendChild(div);
      });
    }

    function toggleAksesBuatAkun() {
      aksesBuatAkun = !aksesBuatAkun;
      document.getElementById("status-akses").innerText = aksesBuatAkun ? "Terbuka" : "Tertutup";
    }

    function gantiNama(i, namaBaru) {
      semuaAkun[i].nama = namaBaru;
      tampilkanDataAdmin();
    }

    function hapusAkun(i) {
      semuaAkun.splice(i, 1);
      tampilkanDataAdmin();
    }

    function buatAkun() {
      if (!aksesBuatAkun) {
        alert("Pembuatan akun sedang ditutup oleh admin.");
        return;
      }
      if (akun) {
        alert("Anda sudah memiliki akun.");
        return;
      }
      const nama = document.getElementById("nama").value;
      if (!nama) return alert("Nama wajib diisi.");
      akun = { nama: nama, uang: 0 };
      semuaAkun.push(akun);
      document.getElementById("akun-nama").innerText = "Halo, " + nama;
      document.getElementById("akun-section").style.display = "block";
      document.getElementById("buat-akun-section").style.display = "none";
      updateUang();
    }

    function tambahUang() {
      akun.uang += 10000;
      updateUang();
    }

    function ambilUang() {
      akun.uang -= 10000;
      if (akun.uang < 0) akun.uang = 0;
      updateUang();
    }

    function resetUang() {
      akun.uang = 0;
      updateUang();
    }

    function updateUang() {
      document.getElementById("uang").innerText = formatUang(akun.uang);
    }

    function formatUang(nilai) {
      return nilai.toLocaleString("id-ID") + "rb";
    }

    function kirimPesan() {
      const pesan = document.getElementById("pesan").value;
      if (!pesan) return;
      const div = document.createElement("div");
      div.innerText = (akun ? akun.nama : "Anonim") + ": " + pesan;
      document.getElementById("chatbox").appendChild(div);
      document.getElementById("pesan").value = "";
    }
  </script>
</body>
</html>
