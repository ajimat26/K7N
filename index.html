<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAFD MONEY</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 0; }
    header { background: #4CAF50; color: white; padding: 10px; text-align: center; }
    main { padding: 20px; }
    .hidden { display: none; }
    .panel, .admin-panel, .forum-panel, .top-tier { background: white; padding: 20px; margin: 10px 0; border-radius: 5px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    .green { color: green; font-weight: bold; }
    button { margin: 5px 0; }
  </style>
</head>
<body>
<header>
  <h1>SAFD MONEY</h1>
</header>
<main>
  <div id="buatAkun" class="panel">
    <h2>Buat Akun</h2>
    <input type="text" id="username" placeholder="Nama Akun"><br>
    <input type="number" id="uang" placeholder="Masukkan uang"><br>
    <button onclick="buatAkun()">Buat</button>
  </div>

  <div id="forumPanel" class="forum-panel hidden">
    <h2>Forum SAFD MONEY</h2>
    <p id="namaForum"></p>
    <p>Uang: <span id="uangDisplay" class="green"></span></p>
    <input type="text" id="chatInput" placeholder="Ketik pesan"><br>
    <button onclick="kirimChat()">Kirim</button>
    <p id="chatArea"></p>
    <button onclick="aksesAdmin()">Admin</button>
  </div>

  <div id="adminLogin" class="admin-panel hidden">
    <h3>Masukkan Password Admin</h3>
    <input type="password" id="adminPass"><br>
    <button onclick="loginAdmin()">Masuk</button>
  </div>

  <div id="adminPanel" class="admin-panel hidden">
    <h2>Panel Admin</h2>
    <p>Nama Admin: <span id="namaAdmin"></span></p>
    <input type="text" id="editAdmin" placeholder="Ubah Nama Admin">
    <button onclick="ubahNamaAdmin()">Ubah Nama</button>

    <h3>Data Akun</h3>
    <ul id="listAkun"></ul>

    <h3>Top Tier</h3>
    <ol id="topTierList"></ol>
  </div>
</main>

<script>
let akun = null;
let akunList = JSON.parse(localStorage.getItem('akunList')) || [];
let adminName = localStorage.getItem('adminName') || "Admin";

function buatAkun() {
  const nama = document.getElementById('username').value.trim();
  const uang = parseInt(document.getElementById('uang').value);
  if (nama && uang) {
    akun = { nama, uang };
    akunList.push(akun);
    localStorage.setItem('akunList', JSON.stringify(akunList));
    document.getElementById('buatAkun').classList.add('hidden');
    tampilForum();
  }
}

function tampilForum() {
  document.getElementById('forumPanel').classList.remove('hidden');
  document.getElementById('namaForum').innerText = "Selamat datang, " + akun.nama;
  document.getElementById('uangDisplay').innerText = formatRupiah(akun.uang);
}

function kirimChat() {
  const input = document.getElementById('chatInput');
  const text = input.value.trim();
  if (text) {
    document.getElementById('chatArea').innerHTML += `<br><b>${akun.nama}:</b> ${text}`;
    input.value = '';
  }
}

function aksesAdmin() {
  document.getElementById('adminLogin').classList.remove('hidden');
}

function loginAdmin() {
  const pass = document.getElementById('adminPass').value;
  if (pass === "RFD1") {
    document.getElementById('adminLogin').classList.add('hidden');
    document.getElementById('adminPanel').classList.remove('hidden');
    document.getElementById('namaAdmin').innerText = adminName;
    tampilkanDataAkun();
    tampilkanTopTier();
    akun.nama = adminName;
  }
}

function ubahNamaAdmin() {
  const newName = document.getElementById('editAdmin').value.trim();
  if (newName) {
    adminName = newName;
    localStorage.setItem('adminName', adminName);
    document.getElementById('namaAdmin').innerText = adminName;
    akun.nama = adminName;
  }
}

function tampilkanDataAkun() {
  const list = document.getElementById('listAkun');
  list.innerHTML = '';
  akunList.forEach((a, i) => {
    const li = document.createElement('li');
    li.innerHTML = `${a.nama} - <span class="green">${formatRupiah(a.uang)}</span>
      <button onclick="ubahNama(${i})">Ubah Nama</button>
      <button onclick="hapusAkun(${i})">Hapus</button>`;
    list.appendChild(li);
  });
}

function tampilkanTopTier() {
  const top = akunList.slice().sort((a, b) => b.uang - a.uang).slice(0, 3);
  const topList = document.getElementById('topTierList');
  topList.innerHTML = '';
  top.forEach((a, i) => {
    const li = document.createElement('li');
    li.textContent = `${a.nama} - ${formatRupiah(a.uang)}`;
    topList.appendChild(li);
  });
}

function ubahNama(index) {
  const newName = prompt("Masukkan nama baru:");
  if (newName) {
    akunList[index].nama = newName;
    localStorage.setItem('akunList', JSON.stringify(akunList));
    tampilkanDataAkun();
    tampilkanTopTier();
  }
}

function hapusAkun(index) {
  akunList.splice(index, 1);
  localStorage.setItem('akunList', JSON.stringify(akunList));
  tampilkanDataAkun();
  tampilkanTopTier();
  if (akun && akun.nama === akunList[index]?.nama) {
    akun = null;
    document.getElementById('forumPanel').classList.add('hidden');
    document.getElementById('buatAkun').classList.remove('hidden');
  }
}

function formatRupiah(angka) {
  return 'Rp ' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
}

window.onload = () => {
  if (akunList.length === 0) {
    document.getElementById('buatAkun').classList.remove('hidden');
  } else {
    akun = akunList[0];
    tampilForum();
  }
};
</script>
</body>
</html>
