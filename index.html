<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Random Box Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #7f7fd5, #86a8e7, #91eae4);
      color: white;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      font-weight: bold;
      border-radius: 10px;
      border: none;
      background: #4CAF50;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #45a049;
    }
    #boxAnimation {
      margin: 20px auto;
      width: 100px;
      height: 100px;
      background: url('https://cdn-icons-png.flaticon.com/512/189/189689.png') no-repeat center;
      background-size: contain;
      animation: none;
    }
    @keyframes shake {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(5deg); }
      75% { transform: rotate(-5deg); }
    }
    .panel { display: none; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin: 10px auto; width: 90%; max-width: 500px; }
    select, input { padding: 10px; width: 100%; margin-top: 5px; margin-bottom: 10px; border-radius: 8px; border: none; }
  </style>
</head>
<body>
  <h1>Random Box Game</h1>
  <div id="boxAnimation"></div>
  <button onclick="openBox()">Buka Kotak</button>
  <div id="notification"></div>
  <h2>Poin: <span id="points">0</span></h2>

  <div>
    <h3>Penarikan Poin</h3>
    <select id="amount">
      <option value="200">50.000 IC - 200 poin</option>
      <option value="400">100.000 IC - 400 poin</option>
      <option value="1000">250.000 IC - 1000 poin</option>
      <option value="2000">500.000 IC - 2000 poin</option>
      <option value="4000">1.000.000 IC - 4000 poin</option>
      <option value="8000">2.000.000 IC - 8000 poin</option>
    </select>
    <input type="text" id="fullname" placeholder="Nama Lengkap" />
    <input type="text" id="account" placeholder="Nomor Rekening" />
    <button onclick="submitWithdraw()">Ajukan Penarikan</button>
    <div id="exchangeMessage"></div>
  </div>

  <button onclick="togglePanel('messagesPanel')">Pesan</button>
  <button onclick="togglePanel('withdrawPanel')">Riwayat Penarikan</button>
  <button onclick="togglePanel('adminPanel')">Panel Admin</button>

  <div id="messagesPanel" class="panel">
    <h3>Pesan</h3>
    <ul id="messagesList"></ul>
    <button onclick="clearMessages()">Hapus Pesan</button>
  </div>

  <div id="withdrawPanel" class="panel">
    <h3>Riwayat Penarikan</h3>
    <ul id="withdrawList"></ul>
  </div>

  <div id="adminPanel" class="panel">
    <h3>Panel Admin</h3>
    <input type="password" id="adminPass" placeholder="Password Admin" />
    <button onclick="confirmWithdraw()">Konfirmasi Penarikan</button>
  </div>

  <audio id="backsound" loop autoplay>
    <source src="https://ia902905.us.archive.org/31/items/money-heist-free-fire/Money%20Heist%20x%20Free%20Fire.mp3" type="audio/mpeg">
  </audio>

  <script>
    let points = parseInt(localStorage.getItem("points")) || 0;
    let messages = JSON.parse(localStorage.getItem("messages") || "[]");
    let withdraws = JSON.parse(localStorage.getItem("withdraws") || "[]");

    const rewards = [
      { name: "Zonk", points: 0 },
      { name: "+10 Poin", points: 10 },
      { name: "+50 Poin", points: 50 },
      { name: "+100 Poin", points: 100 },
      { name: "2x Poin Berikutnya", points: -1 }
    ];
    let doubleNext = false;

    function updatePoints() {
      document.getElementById("points").textContent = points;
      localStorage.setItem("points", points);
    }

    function openBox() {
      const box = document.getElementById("boxAnimation");
      box.style.animation = "shake 1s ease";

      setTimeout(() => {
        box.style.animation = "none";
        const r = rewards[Math.floor(Math.random() * rewards.length)];
        let earned = 0;
        if (r.points === -1) {
          doubleNext = true;
          notify("Bonus 2x Poin di kotak berikutnya!");
          addMessage("Mendapatkan 2x Poin berikutnya!");
        } else {
          earned = doubleNext ? r.points * 2 : r.points;
          doubleNext = false;
          points += earned;
          notify(`Mendapatkan ${earned} poin! (${r.name})`);
          addMessage(`Box reward: ${r.name} (+${earned} poin)`);
        }
        updatePoints();
      }, 1000);
    }

    function notify(msg) {
      document.getElementById("notification").textContent = msg;
    }

    function addMessage(msg) {
      messages.push(msg);
      if (messages.length > 50) messages.shift();
      localStorage.setItem("messages", JSON.stringify(messages));
      renderMessages();
    }

    function renderMessages() {
      const list = document.getElementById("messagesList");
      list.innerHTML = "";
      messages.forEach(m => {
        const li = document.createElement("li");
        li.textContent = m;
        list.appendChild(li);
      });
    }

    function clearMessages() {
      messages = [];
      localStorage.setItem("messages", "[]");
      renderMessages();
    }

    function togglePanel(id) {
      const panels = ["messagesPanel", "withdrawPanel", "adminPanel"];
      panels.forEach(p => document.getElementById(p).style.display = "none");
      document.getElementById(id).style.display = "block";
      if (id === "withdrawPanel") renderWithdraws();
      if (id === "messagesPanel") renderMessages();
    }

    function submitWithdraw() {
      const amount = parseInt(document.getElementById("amount").value);
      const name = document.getElementById("fullname").value;
      const acc = document.getElementById("account").value;

      if (!name || !acc || points < amount) {
        notify("Data tidak lengkap atau poin tidak cukup.");
        return;
      }

      points -= amount;
      updatePoints();
      withdraws.push({ name, acc, amount, confirmed: false });
      localStorage.setItem("withdraws", JSON.stringify(withdraws));
      notify("Penarikan diajukan.");
      addMessage(`Penarikan diajukan: ${name}, ${acc}, ${amount} poin`);
    }

    function renderWithdraws() {
      const list = document.getElementById("withdrawList");
      list.innerHTML = "";
      withdraws.forEach((w, i) => {
        const li = document.createElement("li");
        li.textContent = `${w.name} - ${w.acc} - ${w.amount} poin - ${w.confirmed ? "Sudah dikonfirmasi" : "Menunggu konfirmasi"}`;
        list.appendChild(li);
      });
    }

    function confirmWithdraw() {
      const pass = document.getElementById("adminPass").value;
      if (pass !== "admin123") {
        alert("Password salah!");
        return;
      }
      withdraws = withdraws.map(w => ({ ...w, confirmed: true }));
      localStorage.setItem("withdraws", JSON.stringify(withdraws));
      notify("Semua penarikan dikonfirmasi.");
      renderWithdraws();
    }

    updatePoints();
    renderMessages();
  </script>
</body>
</html>
