<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SAFD MONEY Forum</title>
  <style>
    body { font-family: Arial, sans-serif; background: #eee; padding: 20px; margin: 0; }
    .panel { background: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    h2 { margin-top: 0; }
    .hidden { display: none; }
    input, button { margin-top: 5px; display: block; padding: 8px; width: 100%; max-width: 300px; }
    .chat-box { background: #f9f9f9; padding: 10px; height: 150px; overflow-y: auto; border: 1px solid #ccc; margin-top: 10px; }
    .green { color: green; font-weight: bold; }
  </style>
</head>
<body>

<div class="panel" id="buatAkun">
  <h2>Buat Akun SAFD</h2>
  <input type="text" id="namaAkun" placeholder="Nama Akun"/>
  <input type="number" id="uangAkun" placeholder="Saldo Awal"/>
  <button onclick="buatAkun()">Buat Akun</button>
</div>

<div class="panel hidden" id="forumPanel">
  <h2>Forum SAFD MONEY</h2>
  <p>Selamat datang, <span id="namaPengguna"></span>!</p>
  <p>Saldo: <span id="uangPengguna" class="green"></span></p>
  <input type="text" id="chatInput" placeholder="Tulis pesan..."/>
  <button onclick="kirimChat()">Kirim</button>
  <div class="chat-box" id="chatBox"></div>
  <button onclick="bukaAdmin()">Masuk Admin</button>
</div>

<div class="panel hidden" id="loginAdmin">
  <h2>Login Admin</h2>
  <input type="password" id="adminPassword" placeholder="Password Admin"/>
  <button onclick="loginAdmin()">Login</button>
</div>

<div class="panel hidden" id="adminPanel">
  <h2>Panel Admin</h2>
  <p>Nama Admin: <span id="namaAdminTampil"></span></p>
  <input type="text" id="editNamaAdmin" placeholder="Ubah Nama Admin"/>
  <button onclick="ubahNamaAdmin()">Ubah Nama</button>
  <h3>Daftar Akun</h3>
  <ul id="daftarAkun"></ul>
</div>

<div class="panel" id="topTierPanel">
  <h2>Top Tier Investor</h2>
  <ol id="topTierList"></ol>
</div>

<script>
let akun = null;
let akunList = JSON.parse(localStorage.getItem("akunList")) || [];
let adminName = localStorage.getItem("adminName") || "Admin SAFD";

function simpanAkunList() {
  localStorage.setItem("akunList", JSON.stringify(akunList));
}

function tampilkanTopTier() {
  const sorted = [...akunList].sort((a, b) => b.uang - a.uang).slice(0, 3);
  const list = document.getElementById("topTierList");
  list.innerHTML = "";
  sorted.forEach(a => {
    list.innerHTML += `<li>${a.nama} - <span class="green">Rp ${a.uang.toLocaleString()}</span></li>`;
  });
}

function buatAkun() {
  const nama = document.getElementById("namaAkun").value.trim();
  const uang = parseInt(document.getElementById("uangAkun").value);
  if (!nama || isNaN(uang)) return alert("Isi semua kolom!");

  akun = { nama, uang };
  akunList.push(akun);
  simpanAkunList();
  document.getElementById("buatAkun").classList.add("hidden");
  masukForum();
}

function masukForum() {
  document.getElementById("forumPanel").classList.remove("hidden");
  document.getElementById("namaPengguna").textContent = akun.nama;
  document.getElementById("uangPengguna").textContent = `Rp ${akun.uang.toLocaleString()}`;
  tampilkanTopTier();
}

function kirimChat() {
  const pesan = document.getElementById("chatInput").value.trim();
  if (!pesan) return;
  document.getElementById("chatBox").innerHTML += `<p><b>${akun.nama}:</b> ${pesan}</p>`;
  document.getElementById("chatInput").value = "";
}

function bukaAdmin() {
  document.getElementById("loginAdmin").classList.remove("hidden");
}

function loginAdmin() {
  const pass = document.getElementById("adminPassword").value;
  if (pass !== "RFD1") return alert("Password salah!");
  document.getElementById("loginAdmin").classList.add("hidden");
  document.getElementById("adminPanel").classList.remove("hidden");
  document.getElementById("namaAdminTampil").textContent = adminName;
  tampilkanDaftarAkun();
  akun.nama = adminName;
  document.getElementById("namaPengguna").textContent = adminName;
}

function ubahNamaAdmin() {
  const namaBaru = document.getElementById("editNamaAdmin").value.trim();
  if (!namaBaru) return;
  adminName = namaBaru;
  localStorage.setItem("adminName", adminName);
  document.getElementById("namaAdminTampil").textContent = adminName;
  akun.nama = adminName;
  document.getElementById("namaPengguna").textContent = adminName;
}

function tampilkanDaftarAkun() {
  const ul = document.getElementById("daftarAkun");
  ul.innerHTML = "";
  akunList.forEach((a, i) => {
    ul.innerHTML += `<li>${a.nama} - <span class="green">Rp ${a.uang.toLocaleString()}</span> 
    <button onclick="gantiNama(${i})">Ganti Nama</button> 
    <button onclick="hapusAkun(${i})">Hapus</button></li>`;
  });
}

function gantiNama(index) {
  const namaBaru = prompt("Nama baru:");
  if (!namaBaru) return;
  akunList[index].nama = namaBaru;
  simpanAkunList();
  tampilkanDaftarAkun();
  tampilkanTopTier();
}

function hapusAkun(index) {
  const hapusNama = akunList[index].nama;
  akunList.splice(index, 1);
  simpanAkunList();
  tampilkanDaftarAkun();
  tampilkanTopTier();

  if (akun && akun.nama === hapusNama) {
    akun = null;
    document.getElementById("forumPanel").classList.add("hidden");
    document.getElementById("adminPanel").classList.add("hidden");
    document.getElementById("buatAkun").classList.remove("hidden");
  }
}

window.onload = () => {
  if (akunList.length === 0) {
    document.getElementById("buatAkun").classList.remove("hidden");
  } else {
    akun = akunList[0];
    masukForum();
  }
  tampilkanTopTier();
};
</script>

</body>
</html>
