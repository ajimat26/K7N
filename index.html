<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Game Kotak Hadiah</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #eee;
    text-align: center;
    padding: 20px;
  }
  button {
    margin: 10px;
    padding: 12px 24px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 8px;
    background: #e63946;
    border: none;
    color: white;
    transition: background 0.3s;
  }
  button:hover {
    background: #d62828;
  }
  #notif, #adminNotif {
    margin-top: 15px;
    font-weight: bold;
  }
  #panelPesan, #panelPenarikan, #adminPanel, #adminLoginPanel, #panelSaran, #overlay {
    background: #222;
    border-radius: 12px;
    max-width: 480px;
    margin: 20px auto;
    padding: 20px;
    display: none;
  }
  ul {
    text-align: left;
    max-height: 150px;
    overflow-y: auto;
    padding-left: 20px;
  }
  label {
    display: block;
    margin: 10px 0 5px;
  }
  select, input[type=password], textarea {
    width: 90%;
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
  }
  #overlay {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.8);
    z-index: 1000;
  }
</style>
</head>
<body>

<h1>Game Kotak Hadiah</h1>

<button onclick="openBox()">Buka Kotak</button>
<button onclick="togglePanel('panelPenarikan')">Ajukan Penarikan</button>
<button onclick="togglePanel('panelPesan')">Lihat Pesan</button>
<button onclick="togglePanel('panelSaran')">Kasih Saran Developer</button>
<button onclick="showAdminLogin()">Admin Panel</button>
<button onclick="toggleBGM()"><span id="bgmBtn">Play Backsound</span></button>

<div id="notif"></div>

<!-- Panel Pesan -->
<div id="panelPesan">
  <h3>Pesan & Riwayat</h3>
  <ul id="messageList"></ul>
  <button onclick="hapusPesan()">Hapus Semua Pesan</button>
  <button onclick="togglePanel('panelPesan')">Tutup</button>
</div>

<!-- Panel Penarikan -->
<div id="panelPenarikan">
  <h3>Ajukan Penarikan</h3>
  <label for="penarikanSelect">Pilih Jumlah Penarikan (Poin):</label>
  <select id="penarikanSelect">
    <option value="50000">50.000</option>
    <option value="200000">200.000</option>
    <option value="500000">500.000</option>
    <option value="1000000">1.000.000</option>
    <option value="2000000">2.000.000</option>
  </select>
  <br/>
  <button onclick="ajukanPenarikan()">Kirim Permintaan</button>
  <button onclick="togglePanel('panelPenarikan')">Tutup</button>
  <div id="penarikanNotif" style="margin-top:10px; font-weight:bold;"></div>
</div>

<!-- Panel Saran -->
<div id="panelSaran">
  <h3>Kasih Saran untuk Developer</h3>
  <p>Silahkan klik tombol di bawah untuk mengirim saran via WhatsApp:</p>
  <button onclick="window.open('https://wa.me/6283891019471', '_blank')">Chat WA 0838-9101-9471</button>
  <button onclick="togglePanel('panelSaran')">Tutup</button>
</div>

<!-- Admin Login Panel -->
<div id="adminLoginPanel">
  <h3>Login Admin</h3>
  <input type="password" id="adminPass" placeholder="Masukkan Password Admin" />
  <br/><br/>
  <button onclick="loginAdmin()">Masuk</button>
  <button onclick="closeAdminLogin()">Batal</button>
  <div id="adminLoginNotif" style="color:#f88; margin-top:10px;"></div>
</div>

<!-- Admin Panel -->
<div id="adminPanel">
  <h3>Admin Panel</h3>
  <h4>Permintaan Konfirmasi Penarikan</h4>
  <ul id="withdrawList" style="max-height: 150px; overflow-y:auto; text-align:left; padding-left:20px;"></ul>
  
  <h4>Kontrol Game</h4>
  <label for="closeReason">Alasan Penutupan:</label>
  <textarea id="closeReason" rows="3" placeholder="Masukkan alasan..."></textarea>
  <br/><br/>
  <label for="closeTime">Tutup game selama (menit):</label>
  <input type="number" id="closeTime" min="1" max="1440" value="10" />
  <br/><br/>
  <button onclick="tutupGame()">Tutup Game Sekarang</button>
  <button onclick="bukaGame()">Buka Kembali Game</button>
  <button onclick="logoutAdmin()">Logout Admin</button>
  <div id="adminNotif" style="margin-top:10px; font-weight:bold;"></div>
</div>

<div id="overlay" style="display:none;"></div>

<!-- Audio Backsound -->
<audio id="bgm" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/04/21/audio_2046f1e4db.mp3?filename=epic-suspense-music-11944.mp3" type="audio/mpeg" />
  <!-- Alternatif link jika ingin ganti bisa masukkan di sini -->
</audio>

<script>
  let messages = [];
  let points = 0;
  let adminLoggedIn = false;
  let penarikanRequests = [];
  let gameClosed = false;
  let closeTimeout = null;

  const notif = document.getElementById('notif');
  const messageList = document.getElementById('messageList');
  const withdrawList = document.getElementById('withdrawList');
  const adminPanel = document.getElementById('adminPanel');
  const adminLoginPanel = document.getElementById('adminLoginPanel');
  const adminLoginNotif = document.getElementById('adminLoginNotif');
  const adminNotif = document.getElementById('adminNotif');
  const overlay = document.getElementById('overlay');
  const bgm = document.getElementById('bgm');
  const bgmBtn = document.getElementById('bgmBtn');

  // Fungsi buka kotak hadiah, dapat poin random 1000 - 20000
  function openBox() {
    if(gameClosed) {
      notif.innerText = "Game sedang ditutup sementara: " + document.getElementById('closeReason').value;
      return;
    }
    let earned = Math.floor(Math.random() * 20000) + 1000;
    points += earned;
    addMessage(`Kamu membuka kotak dan mendapatkan ${earned.toLocaleString()} poin! Total poin: ${points.toLocaleString()}`);
    notif.innerText = `Kamu dapat ${earned.toLocaleString()} poin! Total sekarang ${points.toLocaleString()}`;
  }

  // Toggle panel tampil/tutup
  function togglePanel(id) {
    const panel = document.getElementById(id);
    if(panel.style.display === "block") {
      panel.style.display = "none";
      overlay.style.display = "none";
    } else {
      panel.style.display = "block";
      overlay.style.display = "block";
    }
  }

  // Hapus semua pesan
  function hapusPesan() {
    if(confirm("Yakin ingin hapus semua pesan?")) {
      messages = [];
      renderMessages();
      notif.innerText = "Semua pesan telah dihapus.";
    }
  }

  // Tambah pesan baru
  function addMessage(text) {
    messages.push(text);
    renderMessages();
  }

  // Render pesan ke list
  function renderMessages() {
    messageList.innerHTML = "";
    messages.forEach(m => {
      let li = document.createElement('li');
      li.textContent = m;
      messageList.appendChild(li);
    });
  }

  // Ajukan penarikan poin
  function ajukanPenarikan() {
    if(gameClosed) {
      document.getElementById('penarikanNotif').innerText = "Game sedang ditutup, tidak bisa ajukan penarikan.";
      return;
    }
    const val = Number(document.getElementById('penarikanSelect').value);
    if(points < val) {
      document.getElementById('penarikanNotif').innerText = `Poin kamu (${points.toLocaleString()}) tidak cukup untuk penarikan ${val.toLocaleString()}`;
      return;
    }
    // Simpan request penarikan
    penarikanRequests.push({id: Date.now(), jumlah: val});
    points -= val;
    addMessage(`Kamu mengajukan penarikan ${val.toLocaleString()} poin.`);
    document.getElementById('penarikanNotif').innerText = `Penarikan ${val.toLocaleString()} poin telah diajukan. Tunggu konfirmasi admin.`;
    renderPenarikan();
  }

  // Render daftar permintaan penarikan di admin
  function renderPenarikan() {
    withdrawList.innerHTML = "";
    if(penarikanRequests.length === 0) {
      withdrawList.innerHTML = "<li>Tidak ada permintaan penarikan.</li>";
      return;
    }
    penarikanRequests.forEach(req => {
      let li = document.createElement('li');
      li.innerHTML = `ID: ${req.id} - Jumlah: ${req.jumlah.toLocaleString()} poin 
      <button onclick="konfirmasiPenarikan(${req.id})" style="margin-left:10px;">Konfirmasi</button>`;
      withdrawList.appendChild(li);
    });
  }

  // Konfirmasi permintaan penarikan (admin)
  function konfirmasiPenarikan(id) {
    penarikanRequests = penarikanRequests.filter(r => r.id !== id);
    addMessage(`Admin telah mengkonfirmasi penarikan ID: ${id}`);
    adminNotif.innerText = `Penarikan ID: ${id} berhasil dikonfirmasi.`;
    renderPenarikan();
  }

  // Admin login
  function showAdminLogin() {
    if(adminLoggedIn) {
      togglePanel('adminPanel');
      return;
    }
    adminLoginPanel.style.display = "block";
    overlay.style.display = "block";
  }
  function closeAdminLogin() {
    adminLoginPanel.style.display = "none";
    overlay.style.display = "none";
    adminLoginNotif.innerText = "";
    document.getElementById('adminPass').value = "";
  }
  function loginAdmin() {
    const pass = document.getElementById('adminPass').value;
    if(pass === "opicantik") {
      adminLoggedIn = true;
      adminLoginNotif.style.color = "#8f8";
      adminLoginNotif.innerText = "Login berhasil!";
      closeAdminLogin();
      togglePanel('adminPanel');
    } else {
      adminLoginNotif.style.color = "#f88";
      adminLoginNotif.innerText = "Password salah!";
    }
  }

  // Logout admin
  function logoutAdmin() {
    adminLoggedIn = false;
    adminPanel.style.display = "none";
    adminNotif.innerText = "";
    alert("Admin telah logout.");
  }

  // Tutup game sementara (admin)
  function tutupGame() {
    if(!adminLoggedIn) return alert("Kamu bukan admin!");
    const alasan = document.getElementById('closeReason').value.trim();
    const menit = Number(document.getElementById('closeTime').value);
    if(!alasan) return alert("Masukkan alasan penutupan.");
    if(menit <= 0) return alert("Durasi harus > 0 menit.");

    gameClosed = true;
    notif.innerText = `Game ditutup sementara. Alasan: ${alasan}`;
    adminNotif.innerText = `Game ditutup selama ${menit} menit.`;

    // Timer untuk buka game otomatis
    if(closeTimeout) clearTimeout(closeTimeout);
    closeTimeout = setTimeout(() => {
      bukaGame();
    }, menit * 60 * 1000);
  }

  // Buka kembali game (admin)
  function bukaGame() {
    if(!adminLoggedIn) return alert("Kamu bukan admin!");
    gameClosed = false;
    notif.innerText = "Game sudah dibuka kembali.";
    adminNotif.innerText = "Game dibuka kembali oleh admin.";
    if(closeTimeout) {
      clearTimeout(closeTimeout);
      closeTimeout = null;
    }
  }

  // Toggle Backsound
  function toggleBGM() {
    if(bgm.paused) {
      bgm.play();
      bgmBtn.textContent = "Pause Backsound";
    } else {
      bgm.pause();
      bgmBtn.textContent = "Play Backsound";
    }
  }

  // Klik overlay tutup semua panel
  overlay.onclick = function() {
    document.querySelectorAll('#panelPesan, #panelPenarikan, #adminPanel, #adminLoginPanel, #panelSaran').forEach(panel => {
      panel.style.display = 'none';
    });
    overlay.style.display = 'none';
  }
</script>

</body>
  </html>
