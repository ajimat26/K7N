<!DOCTYPE html><html>
<head>
  <title>UANGDUTY</title>
  <style>
    body { font-family: sans-serif; background: #f2f2f2; padding: 20px; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    .admin { color: white; background: green; padding: 5px 10px; border: none; border-radius: 5px; }
    .hidden { display: none; }
    .title { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
    .indicator { font-size: 12px; color: red; margin-top: 5px; }
    .form-group { margin-bottom: 10px; }
    .form-group input { width: 100%; padding: 8px; }
    .form-group button { padding: 8px 12px; }
    .chat-box { border: 1px solid #ccc; height: 150px; overflow-y: scroll; padding: 10px; background: #fafafa; margin-bottom: 10px; }
    .riwayat { font-size: 12px; background: #eee; padding: 5px; margin-top: 5px; border-radius: 4px; }
    .money { color: green; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">UANGDUTY</div>
    <button id="modeAdmin">Mode Admin</button>
    <div id="adminPanel" class="hidden">
      <div class="indicator" id="adminStatus">Admin Nonaktif</div>
      <button onclick="togglePendaftaran()">Tutup/Buka Pendaftaran</button>
      <div id="adminData"></div>
    </div>
    <div id="registerSection">
      <div class="form-group">
        <input type="text" id="username" placeholder="Masukkan Nama">
        <button onclick="buatAkun()">Buat Akun</button>
      </div>
    </div><div id="userPanel" class="hidden">
  <div>Halo, <span id="namaUser"></span></div>
  <div>Uangmu: <span class="money" id="uangUser">Rp 0</span></div>
  <div class="form-group">
    <input type="number" id="jumlahTambah" placeholder="Jumlah Tambah">
    <button onclick="tambahUang()">Tambah Uang</button>
  </div>
  <div class="form-group">
    <input type="number" id="jumlahAmbil" placeholder="Jumlah Ambil">
    <button onclick="ambilUang()">Ambil Uang</button>
  </div>
  <div class="form-group">
    <button onclick="resetUang()">Setor / Reset Uang</button>
  </div>
  <div class="form-group">
    <div><strong>Riwayat (maks 5):</strong></div>
    <div id="riwayatList"></div>
  </div>
  <div class="form-group">
    <div class="chat-box" id="chatBox"></div>
    <input type="text" id="chatInput" placeholder="Ketik pesan...">
    <button onclick="kirimChat()">Kirim</button>
  </div>
</div>

  </div>  <script>
    let akun = localStorage.getItem("akun") ? JSON.parse(localStorage.getItem("akun")) : null;
    let pendaftaranAktif = true;
    let isAdmin = false;

    document.getElementById("modeAdmin").addEventListener("click", function () {
      let pass = prompt("Masukkan password admin:");
      if (pass === "RFD1") {
        isAdmin = true;
        document.getElementById("adminPanel").classList.remove("hidden");
        document.getElementById("adminStatus").textContent = "Admin Aktif";
        document.getElementById("adminStatus").style.color = "green";
        tampilkanAdminData();
      }
    });

    function togglePendaftaran() {
      pendaftaranAktif = !pendaftaranAktif;
      alert("Pendaftaran " + (pendaftaranAktif ? "dibuka" : "ditutup"));
    }

    function buatAkun() {
      if (!pendaftaranAktif) return alert("Pendaftaran sedang ditutup oleh admin.");
      if (akun) return alert("Kamu sudah memiliki akun!");
      let nama = document.getElementById("username").value.trim();
      if (!nama) return alert("Nama tidak boleh kosong!");
      akun = { nama: nama, uang: 0, riwayat: [] };
      localStorage.setItem("akun", JSON.stringify(akun));
      mulai();
    }

    function mulai() {
      if (!akun) return;
      document.getElementById("registerSection").classList.add("hidden");
      document.getElementById("userPanel").classList.remove("hidden");
      document.getElementById("namaUser").textContent = akun.nama;
      updateUang();
      tampilkanRiwayat();
    }

    function tambahUang() {
      let jumlah = parseInt(document.getElementById("jumlahTambah").value);
      if (isNaN(jumlah) || jumlah <= 0) return alert("Jumlah tidak valid.");
      akun.uang += jumlah;
      tambahRiwayat("+" + jumlah);
      simpan();
    }

    function ambilUang() {
      let jumlah = parseInt(document.getElementById("jumlahAmbil").value);
      if (isNaN(jumlah) || jumlah <= 0 || jumlah > akun.uang) return alert("Jumlah tidak valid.");
      akun.uang -= jumlah;
      tambahRiwayat("-" + jumlah);
      simpan();
    }

    function resetUang() {
      akun.uang = 0;
      tambahRiwayat("Reset");
      simpan();
    }

    function tambahRiwayat(aksi) {
      akun.riwayat.unshift(aksi);
      if (akun.riwayat.length > 5) akun.riwayat.pop();
    }

    function tampilkanRiwayat() {
      document.getElementById("riwayatList").innerHTML = akun.riwayat.map(r => `<div class="riwayat">${r}</div>`).join("");
    }

    function updateUang() {
      document.getElementById("uangUser").textContent = "Rp " + akun.uang.toLocaleString("id-ID");
    }

    function simpan() {
      localStorage.setItem("akun", JSON.stringify(akun));
      updateUang();
      tampilkanRiwayat();
    }

    function tampilkanAdminData() {
      let data = localStorage.getItem("akun");
      if (!data) return;
      let user = JSON.parse(data);
      let html = `<div><strong>Nama:</strong> ${user.nama} | <strong>Uang:</strong> Rp ${user.uang.toLocaleString("id-ID")}</div>
        <button onclick="hapusAkun()">Hapus Akun</button>
        <button onclick="ubahNama()">Ubah Nama</button>`;
      document.getElementById("adminData").innerHTML = html;
    }

    function hapusAkun() {
      localStorage.removeItem("akun");
      location.reload();
    }

    function ubahNama() {
      let baru = prompt("Nama baru:", akun.nama);
      if (!baru) return;
      akun.nama = baru;
      simpan();
      tampilkanAdminData();
    }

    function kirimChat() {
      let pesan = document.getElementById("chatInput").value.trim();
      if (!pesan) return;
      let box = document.getElementById("chatBox");
      box.innerHTML += `<div><b>${akun.nama}:</b> ${pesan}</div>`;
      document.getElementById("chatInput").value = "";
      box.scrollTop = box.scrollHeight;
    }

    if (akun) mulai();
  </script></body>
</html>
