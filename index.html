<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SAFD MONEY Forum</title>
  <style>
    body {
      background-color: white;
      font-family: Arial, sans-serif;
      color: #333;
    }
    .panel {
      border: 1px solid #ccc;
      padding: 10px;
      margin: 10px;
      display: none;
      border-radius: 8px;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
    }
    .btn {
      padding: 5px 10px;
      margin: 5px;
      cursor: pointer;
    }
    #chatBox, #topTierList, #logRiwayat {
      height: 150px;
      overflow-y: auto;
      border: 1px solid #aaa;
      padding: 5px;
      background: #f9f9f9;
      margin-top: 5px;
    }
    .money {
      color: green;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>SAFD MONEY Forum</h1>

  <div id="buttons">
    <button class="btn" onclick="togglePanel('buatAkunPanel')">Buat Akun</button>
    <button class="btn" onclick="togglePanel('moneyPanel')">Uang</button>
    <button class="btn" onclick="togglePanel('chatPanel')">Chat</button>
    <button class="btn" onclick="togglePanel('topTierPanel')">Top Tier</button>
    <button class="btn" onclick="togglePanel('adminLoginPanel')">Admin</button>
  </div>

  <div id="buatAkunPanel" class="panel">
    <input id="namaAkun" placeholder="Nama akun">
    <button onclick="buatAkun()">Simpan</button>
  </div>

  <div id="moneyPanel" class="panel">
    <p>Total Uang: <span id="totalUang" class="money">Rp 0</span></p>
    <input id="jumlah" type="number" placeholder="Jumlah">
    <button onclick="tambahUang()">Tambah</button>
    <button onclick="ambilUang()">Ambil</button>
    <button onclick="setorUang()">Setor</button>
  </div>

  <div id="chatPanel" class="panel">
    <div id="chatBox"></div>
    <input id="pesan" placeholder="Ketik pesan">
    <button onclick="kirimPesan()">Kirim</button>
  </div>

  <div id="topTierPanel" class="panel">
    <h3>Top Tier</h3>
    <div id="topTierList"></div>
  </div>

  <div id="adminLoginPanel" class="panel">
    <input id="adminPassword" type="password" placeholder="Password">
    <button onclick="loginAdmin()">Masuk Admin</button>
  </div>

  <div id="adminPanel" class="panel">
    <h3>Panel Admin</h3>
    <div id="adminData"></div>
  </div>

  <div id="logRiwayat" class="panel"></div>

  <script>
    let akun = localStorage.getItem("akun") || null;
    let uang = parseInt(localStorage.getItem("uang")) || 0;
    let isAdmin = false;
    let logRiwayat = JSON.parse(localStorage.getItem("logRiwayat")) || [];

    function togglePanel(id) {
      document.querySelectorAll('.panel').forEach(p => p.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    function buatAkun() {
      const nama = document.getElementById("namaAkun").value.trim();
      if (!nama) return alert("Nama tidak boleh kosong");
      akun = nama;
      uang = 0;
      localStorage.setItem("akun", akun);
      localStorage.setItem("uang", uang);
      update();
      alert("Akun dibuat");
    }

    function update() {
      document.getElementById("totalUang").textContent = formatRupiah(uang);
      updateTopTier();
      updateRiwayat();
      if (akun) document.getElementById("buatAkunPanel").style.display = 'none';
    }

    function formatRupiah(angka) {
      return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR' }).format(angka);
    }

    function tambahUang() {
      const jumlah = parseInt(document.getElementById("jumlah").value);
      if (jumlah > 0) {
        uang += jumlah;
        simpanUang();
        catatRiwayat(`+ Rp ${jumlah}`);
        update();
      }
    }

    function ambilUang() {
      const jumlah = parseInt(document.getElementById("jumlah").value);
      if (jumlah > 0 && uang >= jumlah) {
        uang -= jumlah;
        simpanUang();
        catatRiwayat(`- Rp ${jumlah}`);
        update();
      }
    }

    function setorUang() {
      const jumlah = parseInt(document.getElementById("jumlah").value);
      if (jumlah > 0) {
        uang += jumlah;
        simpanUang();
        catatRiwayat(`Setor Rp ${jumlah}`);
        update();
      }
    }

    function simpanUang() {
      localStorage.setItem("uang", uang);
    }

    function kirimPesan() {
      const pesan = document.getElementById("pesan").value.trim();
      if (!pesan) return;
      const box = document.getElementById("chatBox");
      const nama = isAdmin ? `Admin ${akun}` : akun;
      box.innerHTML += `<p><strong>${nama}:</strong> ${pesan}</p>`;
      document.getElementById("pesan").value = "";
      box.scrollTop = box.scrollHeight;
    }

    function loginAdmin() {
      const pass = document.getElementById("adminPassword").value;
      if (pass === "RFD1") {
        isAdmin = true;
        togglePanel('adminPanel');
        tampilkanDataAdmin();
      } else {
        alert("Password salah");
      }
    }

    function tampilkanDataAdmin() {
      const data = `<p>Akun: ${akun}</p><p>Uang: ${formatRupiah(uang)}</p>
        <button onclick="hapusAkun()">Hapus Akun</button>`;
      document.getElementById("adminData").innerHTML = data;
    }

    function hapusAkun() {
      localStorage.removeItem("akun");
      localStorage.removeItem("uang");
      akun = null;
      uang = 0;
      alert("Akun dihapus");
      location.reload();
    }

    function updateTopTier() {
      const akunTier = [{ nama: akun, uang: uang }];
      akunTier.sort((a, b) => b.uang - a.uang);
      let html = '';
      akunTier.slice(0, 3).forEach((d, i) => {
        html += `<p>#${i + 1} ${d.nama} - ${formatRupiah(d.uang)}</p>`;
      });
      document.getElementById("topTierList").innerHTML = html;
    }

    function catatRiwayat(teks) {
      logRiwayat.unshift(teks);
      if (logRiwayat.length > 5) logRiwayat.pop();
      localStorage.setItem("logRiwayat", JSON.stringify(logRiwayat));
    }

    function updateRiwayat() {
      document.getElementById("logRiwayat").innerHTML = logRiwayat.map(r => `<p>${r}</p>`).join('');
    }

    update();
  </script>
</body>
</html>
