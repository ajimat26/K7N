<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Event Game</title>
  <style>
    body {
      background: #121212;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }

    h1 {
      margin-bottom: 10px;
    }

    .btn {
      background-color: #3498db;
      border: none;
      color: white;
      padding: 12px 24px;
      margin: 8px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }

    .btn:hover {
      background-color: #2980b9;
    }

    #notif {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #444;
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      display: none;
      z-index: 1000;
    }

    #box {
      width: 120px;
      height: 120px;
      background: orange;
      margin: 20px auto;
      border-radius: 8px;
    }

    @keyframes shake {
      0% { transform: translate(1px, 1px) rotate(0deg); }
      20% { transform: translate(-2px, 2px) rotate(-2deg); }
      40% { transform: translate(2px, -1px) rotate(1deg); }
      60% { transform: translate(-1px, 1px) rotate(-1deg); }
      80% { transform: translate(1px, -2px) rotate(2deg); }
      100% { transform: translate(1px, 1px) rotate(0deg); }
    }
  </style>
</head>
<body>
  <div id="notif"></div>

  <h1>Event Peti Hadiah</h1>
  <p>Kunci: <span id="keyCount">0</span> | Poin: <span id="pointCount">0</span></p>

  <div id="box"></div>

  <button class="btn" onclick="bukaBox()">Buka Box</button>
  <button class="btn" onclick="ambilSuplai()">Ambil Suplai</button>

  <script>
    let keys = parseInt(localStorage.getItem("keys") || "0");
    let points = parseInt(localStorage.getItem("points") || "0");
    const STORAGE_LAST_SUPLAI = "lastSuplaiTime";

    function updateKeys() {
      localStorage.setItem("keys", keys);
      document.getElementById("keyCount").innerText = keys;
    }

    function updatePoints() {
      localStorage.setItem("points", points);
      document.getElementById("pointCount").innerText = points;
    }

    function notif(msg) {
      const el = document.getElementById("notif");
      el.innerText = msg;
      el.style.display = "block";
      setTimeout(() => el.style.display = "none", 3000);
    }

    function bukaBox() {
      if (keys <= 0) {
        notif("Kunci tidak cukup!");
        return;
      }
      keys--;
      updateKeys();

      const hadiah = [
        { teks: "Zonk! Tidak dapat apa-apa.", poin: 0 },
        { teks: "Selamat! Dapat 50 poin.", poin: 50 },
        { teks: "Wow! Dapat 100 poin.", poin: 100 },
        { teks: "Dapat 10 poin.", poin: 10 },
        { teks: "Hadiah spesial aktif! (belum tersedia)", poin: -1 }
      ];

      const hasil = hadiah[Math.floor(Math.random() * hadiah.length)];

      if (hasil.poin === -1) {
        notif(hasil.teks);
      } else {
        points += hasil.poin;
        updatePoints();
        notif(hasil.teks);
      }

      const box = document.getElementById("box");
      box.style.animation = "shake 0.5s";
      setTimeout(() => box.style.animation = "", 500);
    }

    function ambilSuplai() {
      const now = Date.now();
      const last = parseInt(localStorage.getItem(STORAGE_LAST_SUPLAI) || "0");
      const satuJam = 60 * 60 * 1000;

      if (now - last < satuJam) {
        const sisa = Math.ceil((satuJam - (now - last)) / 60000);
        notif(`Tunggu ${sisa} menit lagi untuk ambil suplai.`);
        return;
      }

      const bonusKunci = Math.floor(Math.random() * 6) + 15; // 15-20
      const bonusPoin = Math.floor(Math.random() * 171) + 30; // 30-200

      keys += bonusKunci;
      points += bonusPoin;
      updateKeys();
      updatePoints();
      localStorage.setItem(STORAGE_LAST_SUPLAI, now);

      notif(`Kamu dapat ${bonusKunci} kunci & ${bonusPoin} poin dari suplai!`);
    }

    updateKeys();
    updatePoints();
  </script>
</body>
</html>
