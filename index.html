<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8">
  <title>UANGDUTY</title>
  <style>
    body { font-family: sans-serif; background: #f0f0f0; margin: 0; padding: 0; }
    header { background: #4CAF50; color: white; padding: 1em; text-align: center; position: relative; }
    #adminBtn {
      position: absolute;
      left: 10px;
      top: 10px;
      background-color: red;
      color: white;
      padding: 5px 10px;
      border: none;
      cursor: pointer;
    }
    #adminStatus { font-size: 12px; margin-top: 5px; }
    main { padding: 20px; }
    .box { background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; }
    button { margin: 3px; }
    .hidden { display: none; }
    .green { background-color: green; }
    .red { background-color: red; }
    input, button { padding: 8px; }
    #chatLog { max-height: 150px; overflow-y: auto; background: #e0e0e0; padding: 5px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <header>
    <button id="adminBtn">Mode Admin</button>
    <h1>UANGDUTY</h1>
    <div id="adminStatus">Status: Nonaktif</div>
  </header>  <main>
    <div class="box" id="akunSection">
      <h3>Buat Akun</h3>
      <input type="text" id="namaAkun" placeholder="Nama akun">
      <button onclick="buatAkun()">Buat</button>
      <div id="infoAkun"></div>
    </div><div class="box hidden" id="keuangan">
  <h3>Menu Keuangan</h3>
  <div>Saldo: <span id="saldo" style="color:green">0rb</span></div>
  <button onclick="tambahUang()">Tambah Uang</button>
  <button onclick="ambilUang()">Ambil Uang</button>
  <button onclick="resetUang()">Setor (Reset)</button>
</div>

<div class="box">
  <h3>Obrolan</h3>
  <div id="chatLog"></div>
  <input type="text" id="chatInput" placeholder="Ketik pesan">
  <button onclick="kirimChat()">Kirim</button>
</div>

<div class="box hidden" id="adminPanel">
  <h3>Panel Admin</h3>
  <button onclick="toggleAkunAccess()">Buka/Tutup Pembuatan Akun</button>
  <div>Status Pembuatan Akun: <span id="akunStatus">Dibuka</span></div>
  <div id="listAkun"></div>
</div>

  </main>  <script>
    let akun = null;
    let saldo = 0;
    let akunDiizinkan = true;
    let modeAdmin = false;
    const dataAkun = [];

    function updateUI() {
      document.getElementById("keuangan").classList.toggle("hidden", akun === null);
      document.getElementById("akunSection").classList.toggle("hidden", akun !== null || !akunDiizinkan);
      document.getElementById("infoAkun").innerText = akun === null && !akunDiizinkan ? 'Pembuatan akun ditutup oleh admin.' : '';
      document.getElementById("saldo").innerText = saldo.toLocaleString('id-ID') + 'rb';
      document.getElementById("akunStatus").innerText = akunDiizinkan ? 'Dibuka' : 'Ditutup';
      document.getElementById("adminStatus").innerText = 'Status: ' + (modeAdmin ? 'Aktif' : 'Nonaktif');
      document.getElementById("adminBtn").style.backgroundColor = modeAdmin ? 'green' : 'red';
      document.getElementById("adminPanel").classList.toggle("hidden", !modeAdmin);

      if (modeAdmin) {
        let list = dataAkun.map((a, i) => `
          <div>
            ${a.nama} - ${a.saldo.toLocaleString('id-ID')}rb
            <button onclick="hapusAkun(${i})">Hapus</button>
            <button onclick="ubahNama(${i})">Ubah Nama</button>
          </div>
        `).join('');
        document.getElementById("listAkun").innerHTML = list;
      }
    }

    function buatAkun() {
      const nama = document.getElementById("namaAkun").value.trim();
      if (!nama || akun !== null || !akunDiizinkan) return;
      akun = nama;
      saldo = 0;
      dataAkun.push({ nama: akun, saldo });
      updateUI();
    }

    function tambahUang() {
      saldo += 50000;
      simpanSaldo();
      updateUI();
    }

    function ambilUang() {
      if (saldo >= 50000) saldo -= 50000;
      simpanSaldo();
      updateUI();
    }

    function resetUang() {
      saldo = 0;
      simpanSaldo();
      updateUI();
    }

    function simpanSaldo() {
      const index = dataAkun.findIndex(a => a.nama === akun);
      if (index !== -1) dataAkun[index].saldo = saldo;
    }

    function kirimChat() {
      const isi = document.getElementById("chatInput").value;
      if (!isi) return;
      const log = document.getElementById("chatLog");
      log.innerHTML += `<div><b>${akun || 'Anon'}:</b> ${isi}</div>`;
      document.getElementById("chatInput").value = '';
      log.scrollTop = log.scrollHeight;
    }

    document.getElementById("adminBtn").onclick = function () {
      if (!modeAdmin) {
        const pass = prompt("Masukkan password admin:");
        if (pass === "RFD1") modeAdmin = true;
      } else {
        modeAdmin = false;
      }
      updateUI();
    }

    function toggleAkunAccess() {
      akunDiizinkan = !akunDiizinkan;
      updateUI();
    }

    function hapusAkun(i) {
      dataAkun.splice(i, 1);
      if (akun && dataAkun.every(a => a.nama !== akun)) akun = null;
      updateUI();
    }

    function ubahNama(i) {
      const baru = prompt("Masukkan nama baru:");
      if (baru) {
        dataAkun[i].nama = baru;
        if (akun === dataAkun[i].nama) akun = baru;
        updateUI();
      }
    }

    updateUI();
  </script></body>
                                </html>
