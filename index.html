<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Game Kotak Hadiah - Versi Lengkap</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #121212;
    color: #eee;
    text-align: center;
    padding: 20px;
  }
  button {
    margin: 10px;
    padding: 12px 25px;
    font-size: 16px;
    border-radius: 8px;
    background-color: #e63946;
    border: none;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #d62828;
  }
  #notif, #adminNotif {
    margin-top: 15px;
    font-weight: bold;
  }
  #panelPesan, #panelPenarikan, #adminPanel, #adminLoginPanel, #panelSaran, #overlay {
    background-color: #222;
    border-radius: 12px;
    max-width: 480px;
    margin: 20px auto;
    padding: 20px;
    display: none;
    text-align: left;
  }
  ul {
    max-height: 150px;
    overflow-y: auto;
    padding-left: 20px;
  }
  label {
    display: block;
    margin: 10px 0 5px;
  }
  select, input[type=password], textarea, input[type=number] {
    width: 90%;
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
  }
  #overlay {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.8);
    z-index: 1000;
  }
</style>
</head>
<body>

<h1>Game Kotak Hadiah - Versi Lengkap</h1>

<button onclick="openBox()">Buka Kotak</button>
<button onclick="togglePanel('panelPenarikan')">Ajukan Penarikan</button>
<button onclick="togglePanel('panelPesan')">Lihat Pesan</button>
<button onclick="togglePanel('panelSaran')">Kasih Saran Developer</button>
<button onclick="showAdminLogin()">Admin Panel</button>
<button onclick="toggleBGM()"><span id="bgmBtn">Play Backsound</span></button>

<div id="notif"></div>

<!-- Panel Pesan -->
<div id="panelPesan">
  <h3>Pesan & Riwayat</h3>
  <ul id="messageList"></ul>
  <button onclick="hapusPesan()">Hapus Semua Pesan</button>
  <button onclick="togglePanel('panelPesan')">Tutup</button>
</div>

<!-- Panel Penarikan -->
<div id="panelPenarikan">
  <h3>Ajukan Penarikan</h3>
  <label for="penarikanSelect">Pilih Jumlah Penarikan (Poin):</label>
  <select id="penarikanSelect">
    <option value="50000">50.000</option>
    <option value="200000">200.000</option>
    <option value="500000">500.000</option>
    <option value="1000000">1.000.000</option>
    <option value="2000000">2.000.000</option>
  </select>
  <br/><br/>
  <button onclick="ajukanPenarikan()">Kirim Permintaan</button>
  <button onclick="togglePanel('panelPenarikan')">Tutup</button>
  <div id="penarikanNotif" style="margin-top:10px; font-weight:bold;"></div>
</div>

<!-- Panel Saran -->
<div id="panelSaran">
  <h3>Kasih Saran untuk Developer</h3>
  <p>Silahkan klik tombol di bawah untuk mengirim saran via WhatsApp:</p>
  <button onclick="window.open('https://wa.me/6283891019471', '_blank')">Chat WA 0838-9101-9471</button>
  <button onclick="togglePanel('panelSaran')">Tutup</button>
</div>

<!-- Admin Login Panel -->
<div id="adminLoginPanel">
  <h3>Login Admin</h3>
  <input type="password" id="adminPass" placeholder="Masukkan Password Admin" />
  <br/><br/>
  <button onclick="loginAdmin()">Masuk</button>
  <button onclick="closeAdminLogin()">Batal</button>
  <div id="adminLoginNotif" style="color:#f88; margin-top:10px;"></div>
</div>

<!-- Admin Panel -->
<div id="adminPanel">
  <h3>Admin Panel</h3>
  
  <h4>Permintaan Konfirmasi Penarikan</h4>
  <ul id="withdrawList"></ul>
  
  <h4>Kontrol Game</h4>
  <label for="closeReason">Alasan Penutupan:</label>
  <textarea id="closeReason" rows="3" placeholder="Masukkan alasan..."></textarea>
  <br/><br/>
  <label for="closeTime">Tutup game selama (menit):</label>
  <input type="number" id="closeTime" min="1" max="1440" value="10" />
  <br/><br/>
  <button onclick="tutupGame()">Tutup Game Sekarang</button>
  <button onclick="bukaGame()">Buka Kembali Game</button>
  <button onclick="logoutAdmin()">Logout Admin</button>
  <div id="adminNotif" style="margin-top:10px; font-weight:bold;"></div>
</div>

<div id="overlay" onclick="closeAllPanels()" style="display:none;"></div>

<!-- Audio Backsound -->
<audio id="bgm" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/04/21/audio_2046f1e4db.mp3?filename=epic-suspense-music-11944.mp3" type="audio/mpeg" />
</audio>

<script>
  // Data utama
  let messages = [];
  let points = 0;
  let adminLoggedIn = false;
  let penarikanRequests = [];
  let gameClosed = false;
  let closeTimeout = null;

  // Elemen
  const notif = document.getElementById('notif');
  const messageList = document.getElementById('messageList');
  const withdrawList = document.getElementById('withdrawList');
  const adminPanel = document.getElementById('adminPanel');
  const adminLoginPanel = document.getElementById('adminLoginPanel');
  const adminLoginNotif = document.getElementById('adminLoginNotif');
  const adminNotif = document.getElementById('adminNotif');
  const overlay = document.getElementById('overlay');
  const bgm = document.getElementById('bgm');
  const bgmBtn = document.getElementById('bgmBtn');

  // Buka kotak hadiah, dapat poin random antara 1000 - 20000
  function openBox() {
    if(gameClosed) {
      notif.innerText = "Game sedang ditutup sementara: " + document.getElementById('closeReason').value;
      return;
    }
    const earned = Math.floor(Math.random() * 19001) + 1000;
    points += earned;
    addMessage(`Kamu membuka kotak dan mendapatkan ${earned.toLocaleString()} poin! Total poin: ${points.toLocaleString()}`);
    notif.innerText = `Kamu dapat ${earned.toLocaleString()} poin! Total sekarang ${points.toLocaleString()}`;
  }

  // Toggle panel buka/tutup
  function togglePanel(id) {
    const panel = document.getElementById(id);
    if(panel.style.display === "block") {
      panel.style.display = "none";
      overlay.style.display = "none";
    } else {
      closeAllPanels();
      panel.style.display = "block";
      overlay.style.display = "block";
    }
  }
  // Tutup semua panel (dipanggil saat klik overlay)
  function closeAllPanels() {
    const panels = ['panelPesan', 'panelPenarikan', 'panelSaran', 'adminPanel', 'adminLoginPanel'];
    panels.forEach(id => document.getElementById(id).style.display = "none");
    overlay.style.display = "none";
    adminLoginNotif.innerText = "";
  }

  // Tambah pesan baru
  function addMessage(text) {
    messages.push(text);
    renderMessages();
  }
