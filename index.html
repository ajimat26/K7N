<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Game Spin Bubble - Dapatkan Poin</title>
<style>
  body {
    margin: 0; 
    overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
    color: #fff;
    user-select: none;
  }

  #points {
    position: fixed;
    top: 20px;
    left: 20px;
    font-size: 24px;
    font-weight: 700;
    text-shadow: 0 0 6px rgba(0,0,0,0.5);
  }

  #spinBtn {
    position: fixed;
    bottom: 50px;
    left: 50%;
    transform: translateX(-50%);
    background: #ff6f61;
    border-radius: 50%;
    border: none;
    width: 120px;
    height: 120px;
    font-size: 28px;
    font-weight: 700;
    color: white;
    box-shadow: 0 0 20px #ff6f61;
    cursor: pointer;
    transition: transform 0.2s ease;
    outline: none;
  }
  #spinBtn:active {
    transform: translateX(-50%) scale(0.95);
  }

  #message {
    position: fixed;
    bottom: 190px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 20px;
    font-weight: 600;
    padding: 10px 25px;
    background: rgba(0,0,0,0.3);
    border-radius: 30px;
    text-align: center;
    min-width: 220px;
    user-select: none;
  }

  /* Bubble style */
  .bubble {
    position: absolute;
    background: rgba(255,255,255,0.4);
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(255,255,255,0.8);
    animation-timing-function: linear;
    pointer-events: none;
    user-select: none;
  }
</style>
</head>
<body>

<div id="points">Poin: 0</div>
<button id="spinBtn">SPIN</button>
<div id="message"></div>

<script>
  // Backsound
  const audio = new Audio('https://cdn.pixabay.com/download/audio/2022/02/11/audio_c2eb2b5d05.mp3?filename=upbeat-corporate-ambient-8083.mp3');
  audio.loop = true;
  audio.volume = 0.15;
  audio.play();

  // Points and spin logic
  let points = localStorage.getItem('points') ? parseInt(localStorage.getItem('points')) : 0;
  const pointsDisplay = document.getElementById('points');
  const spinBtn = document.getElementById('spinBtn');
  const message = document.getElementById('message');

  const rewards = [
    { type: 'zonk', chance: 30, message: 'Zonk! Tidak dapat poin.' },
    { type: 'small', chance: 30, value: 10, message: '+10 Poin' },
    { type: 'medium', chance: 20, value: 25, message: '+25 Poin' },
    { type: 'big', chance: 15, value: 50, message: '+50 Poin' },
    { type: 'double', chance: 5, message: 'Gandakan poin! Spin berikutnya dapat 2x lipat' }
  ];

  let doubleNext = false;

  function weightedRandom(rewards) {
    let total = rewards.reduce((acc, r) => acc + r.chance, 0);
    let rand = Math.random() * total;
    let sum = 0;
    for (let r of rewards) {
      sum += r.chance;
      if (rand <= sum) return r;
    }
  }

  function updatePointsDisplay() {
    pointsDisplay.textContent = `Poin: ${points}`;
  }

  function createBubble(text, x, y, size, color) {
    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    bubble.style.left = x + 'px';
    bubble.style.top = y + 'px';
    bubble.style.width = size + 'px';
    bubble.style.height = size + 'px';
    bubble.style.lineHeight = size + 'px';
    bubble.style.fontWeight = '700';
    bubble.style.fontSize = (size/3) + 'px';
    bubble.style.color = color || '#fff';
    bubble.style.textAlign = 'center';
    bubble.style.userSelect = 'none';
    bubble.textContent = text;
    document.body.appendChild(bubble);

    // Animate bubble floating upwards and fading
    let posY = y;
    let alpha = 1;
    const speed = Math.random() * 1 + 0.5;
    const floatInterval = setInterval(() => {
      posY -= speed;
      alpha -= 0.02;
      bubble.style.top = posY + 'px';
      bubble.style.opacity = alpha;
      if (alpha <= 0) {
        clearInterval(floatInterval);
        bubble.remove();
      }
    }, 30);
  }

  spinBtn.onclick = () => {
    spinBtn.disabled = true;
    message.textContent = "Memutar...";
    
    // Spin sound
    const spinSound = new Audio('https://cdn.pixabay.com/download/audio/2021/10/07/audio_8a868bf6ca.mp3?filename=slot-machine-spin-7077.mp3');
    spinSound.volume = 0.4;
    spinSound.play();

    setTimeout(() => {
      let reward = weightedRandom(rewards);
      if (reward.type === 'zonk') {
        message.textContent = reward.message;
        createBubble('Zonk', window.innerWidth/2 - 40, window.innerHeight - 200, 80, '#ff4444');
      } else if (reward.type === 'double') {
        doubleNext = true;
        message.textContent = reward.message;
        createBubble('2x', window.innerWidth/2 - 30, window.innerHeight - 200, 80, '#ffd700');
      } else {
        let rewardPoints = reward.value;
        if (doubleNext) {
          rewardPoints *= 2;
          doubleNext = false;
          message.textContent = reward.message + ' (x2)';
        } else {
          message.textContent = reward.message;
        }
        points += rewardPoints;
        localStorage.setItem('points', points);
        updatePointsDisplay();
        createBubble('+' + rewardPoints, window.innerWidth/2 - 40, window.innerHeight - 200, 80, '#4caf50');
      }
      spinBtn.disabled = false;
    }, 2200);
  };

  updatePointsDisplay();

  // Animate floating background bubbles
  function createBackgroundBubble() {
    const size = Math.random() * 60 + 20;
    const x = Math.random() * window.innerWidth;
    const y = window.innerHeight + size;
    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    bubble.style.width = size + 'px';
    bubble.style.height = size + 'px';
    bubble.style.left = x + 'px';
    bubble.style.top = y + 'px';
    bubble.style.background = 'rgba(255,255,255,0.15)';
    bubble.style.boxShadow = '0 0 15px rgba(255,255,255,0.4)';
    bubble.style.animation = `floatUp ${10 + Math.random()*10}s linear forwards`;
    document.body.appendChild(bubble);

    let posY = y;
    const speed = Math.random() * 0.3 + 0.15;
    const interval = setInterval(() => {
      posY -= speed;
      bubble.style.top = posY + 'px';
      if (posY < -size) {
        clearInterval(interval);
        bubble.remove();
      }
    }, 30);
  }

  setInterval(createBackgroundBubble, 800);

  // CSS animation keyframes added dynamically
  const styleSheet = document.styleSheets[0];
  styleSheet.insertRule(`@keyframes floatUp {
    from { transform: translateY(0); opacity: 1; }
    to { transform: translateY(-100vh); opacity: 0; }
  }`, styleSheet.cssRules.length);

</script>

</body>
</html>
