<!DOCTYPE html>
<html>
<head>
  <title>UANGDUTY</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #eee;
      text-align: center;
      padding-top: 50px;
    }
    #admin-button {
      position: absolute;
      top: 10px;
      left: 10px;
      background: red;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
    }
    #admin-indicator {
      font-size: 12px;
      margin-top: 3px;
    }
    .box {
      background: white;
      padding: 20px;
      display: inline-block;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 10px;
      margin: 5px;
    }
    .green { color: green; font-weight: bold; }
    #admin-panel {
      display: none;
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

  <button id="admin-button" onclick="adminPrompt()">Mode Admin</button>
  <div id="admin-indicator">[Admin: Nonaktif]</div>

  <div class="box">
    <h2>UANGDUTY</h2>

    <div id="buat-akun">
      <input id="nama" placeholder="Nama Anda">
      <button onclick="buatAkun()">Buat Akun</button>
    </div>

    <div id="akun" style="display:none;">
      <h3 id="akun-nama"></h3>
      <p>Uang Anda: <span id="uang" class="green">0rb</span></p>
      <button onclick="tambahUang()">Tambah Uang</button>
      <button onclick="ambilUang()">Ambil Uang</button>
      <button onclick="resetUang()">Setor (Reset)</button>
    </div>

    <div style="margin-top:20px;">
      <input id="pesan" placeholder="Tulis pesan">
      <button onclick="kirimPesan()">Kirim</button>
      <div id="chatbox" style="margin-top:10px;"></div>
    </div>

    <div id="admin-panel">
      <h3>Panel Admin</h3>
      <button onclick="toggleAkses()">Akses Buat Akun: <span id="akses-info">Tertutup</span></button>
      <div id="data-akun" style="margin-top:10px;"></div>
    </div>
  </div>

  <script>
    let akun = null;
    let semuaAkun = [];
    let adminMode = false;
    let aksesBuka = false;

    function adminPrompt() {
      if (adminMode) {
        adminMode = false;
        document.getElementById("admin-panel").style.display = "none";
        document.getElementById("admin-button").style.background = "red";
        document.getElementById("admin-indicator").innerText = "[Admin: Nonaktif]";
      } else {
        const pw = prompt("Masukkan password admin:");
        if (pw === "RFD1") {
          adminMode = true;
          document.getElementById("admin-panel").style.display = "block";
          document.getElementById("admin-button").style.background = "green";
          document.getElementById("admin-indicator").innerText = "[Admin: Aktif]";
          tampilkanAkunAdmin();
        } else {
          alert("Password salah!");
        }
      }
    }

    function toggleAkses() {
      aksesBuka = !aksesBuka;
      document.getElementById("akses-info").innerText = aksesBuka ? "Terbuka" : "Tertutup";
    }

    function tampilkanAkunAdmin() {
      const wadah = document.getElementById("data-akun");
      wadah.innerHTML = "";
      semuaAkun.forEach((a, i) => {
        let el = document.createElement("div");
        el.innerHTML = `
          ${i+1}. <input value="${a.nama}" onchange="ubahNama(${i}, this.value)"> 
          - <span class="green">${formatUang(a.uang)}</span> 
          <button onclick="hapusAkun(${i})">Hapus</button>
        `;
        wadah.appendChild(el);
      });
    }

    function ubahNama(index, baru) {
      semuaAkun[index].nama = baru;
      tampilkanAkunAdmin();
    }

    function hapusAkun(index) {
      semuaAkun.splice(index, 1);
      tampilkanAkunAdmin();
    }

    function buatAkun() {
      if (!aksesBuka) {
        alert("Admin telah menutup pembuatan akun.");
        return;
      }
      if (akun) {
        alert("Anda sudah memiliki akun.");
        return;
      }
      let nama = document.getElementById("nama").value;
      if (!nama) return alert("Isi nama terlebih dahulu.");
      akun = { nama: nama, uang: 0 };
      semuaAkun.push(akun);
      document.getElementById("akun-nama").innerText = "Halo, " + nama;
      document.getElementById("buat-akun").style.display = "none";
      document.getElementById("akun").style.display = "block";
      updateUang();
    }

    function tambahUang() {
      akun.uang += 10000;
      updateUang();
    }

    function ambilUang() {
      akun.uang -= 10000;
      if (akun.uang < 0) akun.uang = 0;
      updateUang();
    }

    function resetUang() {
      akun.uang = 0;
      updateUang();
    }

    function updateUang() {
      document.getElementById("uang").innerText = formatUang(akun.uang);
    }

    function formatUang(nilai) {
      return nilai.toLocaleString("id-ID") + "rb";
    }

    function kirimPesan() {
      let isi = document.getElementById("pesan").value;
      if (!isi) return;
      let dari = akun ? akun.nama : "Anonim";
      let box = document.getElementById("chatbox");
      let el = document.createElement("div");
      el.innerText = dari + ": " + isi;
      box.appendChild(el);
      document.getElementById("pesan").value = "";
    }
  </script>
</body>
</html>
