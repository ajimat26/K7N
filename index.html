<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>UANGDUTY</title>
  <style>
    body {
      font-family: Arial;
      background-color: #f5f5f5;
      margin: 20px;
    }
    h1 {
      text-align: center;
      color: #2d2d2d;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    button {
      margin: 5px 0;
      padding: 10px;
      width: 100%;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .green { background-color: #4CAF50; color: white; }
    .red { background-color: #f44336; color: white; }
    .gray { background-color: #ccc; color: #333; }
    .log {
      background: #eee;
      padding: 10px;
      border-radius: 5px;
      height: 100px;
      overflow-y: auto;
      margin-top: 10px;
    }
    #adminBtn {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 5px 10px;
    }
  </style>
</head>
<body>

<h1>UANGDUTY</h1>

<button id="adminBtn" class="red">Mode Admin</button>

<div class="container">
  <div id="akunSection">
    <input type="text" id="namaInput" placeholder="Nama Pegawai">
    <button class="green" onclick="buatAkun()">Buat Akun</button>
  </div>

  <div id="uangSection" style="display:none;">
    <h3 id="namaTampil"></h3>
    <p>Saldo: <span id="uangTampil" style="color:green;">Rp 0</span></p>
    <button onclick="tambahUang()" class="green">Tambah Uang</button>
    <button onclick="ambilUang()" class="gray">Ambil Uang</button>
    <button onclick="resetUang()" class="red">Setor / Reset Uang</button>
    <button onclick="bukaChat()" class="gray">Buka Chat</button>
  </div>

  <div id="chatSection" style="display:none;">
    <textarea id="chatLog" rows="5" readonly style="width:100%;"></textarea>
    <input type="text" id="pesanInput" placeholder="Ketik pesan...">
    <button onclick="kirimPesan()" class="green">Kirim</button>
  </div>

  <div class="log" id="logRiwayat"></div>
</div>

<!-- Modal password -->
<div id="modalPassword" style="display:none; position:fixed; top:40%; left:50%; transform:translate(-50%, -50%);
 background:white; padding:20px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.3);">
  <h3>Masukkan Password Admin</h3>
  <input type="password" id="adminPasswordInput" placeholder="Password">
  <button onclick="cekPassword()" class="green">Masuk</button>
</div>

<script>
let akun = null;
let uang = 0;
let log = [];
let isAdmin = false;
let daftarBuka = true;

document.getElementById("adminBtn").addEventListener("click", () => {
  if (!isAdmin) {
    document.getElementById("modalPassword").style.display = "block";
  } else {
    isAdmin = false;
    document.getElementById("adminBtn").textContent = "Mode Admin";
    document.getElementById("adminBtn").className = "red";
    alert("Keluar dari Mode Admin");
  }
});

function cekPassword() {
  const input = document.getElementById("adminPasswordInput").value;
  if (input === "RFD1") {
    isAdmin = true;
    document.getElementById("modalPassword").style.display = "none";
    document.getElementById("adminBtn").textContent = "Admin Aktif";
    document.getElementById("adminBtn").className = "green";
    alert("Admin Mode Aktif");
    tampilkanKontrolAdmin();
  } else {
    alert("Password salah!");
  }
}

function tampilkanKontrolAdmin() {
  if (!document.getElementById("adminControl")) {
    const adminDiv = document.createElement("div");
    adminDiv.id = "adminControl";
    adminDiv.innerHTML = `
      <button onclick="togglePendaftaran()" class="gray">
        ${daftarBuka ? 'Tutup' : 'Buka'} Pendaftaran
      </button>
      <button onclick="editAkun()" class="green">Edit Nama Akun</button>
      <button onclick="hapusAkun()" class="red">Hapus Akun</button>
    `;
    document.querySelector(".container").appendChild(adminDiv);
  }
}

function togglePendaftaran() {
  daftarBuka = !daftarBuka;
  alert(daftarBuka ? "Pendaftaran Dibuka" : "Pendaftaran Ditutup");
}

function buatAkun() {
  const nama = document.getElementById("namaInput").value.trim();
  if (!daftarBuka) return alert("Pendaftaran ditutup oleh Admin.");
  if (akun) return alert("Anda sudah memiliki akun.");
  if (nama === "") return alert("Nama tidak boleh kosong.");
  akun = nama;
  document.getElementById("akunSection").style.display = "none";
  document.getElementById("uangSection").style.display = "block";
  document.getElementById("namaTampil").textContent = "Halo, " + akun;
  logAktivitas("Akun dibuat: " + akun);
}

function tambahUang() {
  uang += 50000;
  tampilkanUang();
  logAktivitas("Menambah uang: Rp 50.000");
}

function ambilUang() {
  if (uang < 50000) return alert("Saldo tidak cukup.");
  uang -= 50000;
  tampilkanUang();
  logAktivitas("Mengambil uang: Rp 50.000");
}

function resetUang() {
  uang = 0;
  tampilkanUang();
  logAktivitas("Saldo disetor/reset");
}

function tampilkanUang() {
  document.getElementById("uangTampil").textContent = "Rp " + uang.toLocaleString('id-ID');
}

function bukaChat() {
  document.getElementById("chatSection").style.display = "block";
}

function kirimPesan() {
  const pesan = document.getElementById("pesanInput").value.trim();
  if (pesan === "") return;
  const waktu = new Date().toLocaleTimeString();
  const format = `[${waktu}] ${akun}: ${pesan}`;
  document.getElementById("chatLog").value += format + "\n";
  document.getElementById("pesanInput").value = "";
}

function logAktivitas(teks) {
  if (log.length >= 5) log.shift();
  log.push(teks);
  document.getElementById("logRiwayat").innerHTML = log.map(l => "<div>" + l + "</div>").join("");
}

function hapusAkun() {
  if (!akun) return alert("Tidak ada akun untuk dihapus.");
  if (confirm("Yakin hapus akun ini?")) {
    akun = null;
    uang = 0;
    document.getElementById("akunSection").style.display = "block";
    document.getElementById("uangSection").style.display = "none";
    document.getElementById("chatSection").style.display = "none";
    document.getElementById("logRiwayat").innerHTML = "";
    document.getElementById("chatLog").value = "";
    alert("Akun dihapus.");
  }
}

function editAkun() {
  if (!akun) return alert("Tidak ada akun.");
  const baru = prompt("Masukkan nama baru:", akun);
  if (baru && baru.trim() !== "") {
    akun = baru.trim();
    document.getElementById("namaTampil").textContent = "Halo, " + akun;
    logAktivitas("Nama akun diubah menjadi " + akun);
  }
}
</script>
</body>
</html>
