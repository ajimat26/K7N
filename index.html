<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8">
  <title>UANGDUTY</title>
  <style>
    body { font-family: Arial; background: #f0f0f0; margin: 0; padding: 0; }
    .container { max-width: 600px; margin: 30px auto; background: white; padding: 20px; border-radius: 10px; }
    h1 { text-align: center; margin-top: 0; }
    .green { color: green; }
    .admin-button { background: red; color: white; padding: 5px 10px; border: none; cursor: pointer; border-radius: 5px; }
    .admin-button.active { background: green; }
    .admin-panel { display: none; margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px; }
    .log, .chat, .akun-list { max-height: 120px; overflow-y: auto; background: #eee; padding: 5px; margin-top: 10px; border-radius: 5px; }
    input[type=text], input[type=number] { padding: 5px; width: 100%; box-sizing: border-box; margin-bottom: 10px; }
    button { padding: 5px 10px; margin-right: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>UANGDUTY</h1>
    <button id="adminToggle" class="admin-button">Mode Admin</button><div id="adminPanel" class="admin-panel">
  <p><b>Panel Admin</b> - <span id="daftarToggle">[Tutup Pendaftaran]</span></p>
  <div class="akun-list" id="akunList"></div>
</div>

<div id="buatAkunPanel">
  <input type="text" id="namaInput" placeholder="Masukkan nama anda">
  <button onclick="buatAkun()">Buat Akun</button>
</div>

<div id="akunPanel" style="display:none">
  <p>Halo, <span id="namaPengguna"></span>!</p>
  <p>Saldo: <span id="saldoPengguna" class="green"></span>rb</p>
  <input type="number" id="jumlahUang" placeholder="Jumlah uang">
  <button onclick="tambahUang()">Tambah Uang</button>
  <button onclick="ambilUang()">Ambil Uang</button>
  <button onclick="resetUang()">Setor (Reset Uang)</button>
  <div class="log" id="riwayatLog"></div>
  <input type="text" id="chatInput" placeholder="Ketik pesan...">
  <button onclick="kirimChat()">Kirim</button>
  <div class="chat" id="chatBox"></div>
</div>

  </div>  <script>
    let isAdmin = false;
    let pendaftaranTerbuka = true;
    let akun = null;
    let dataAkun = [];
    let chatList = [];

    document.getElementById('adminToggle').onclick = () => {
      if (!isAdmin) {
        const pass = prompt("Masukkan password admin:");
        if (pass === "RFD1") {
          isAdmin = true;
          document.getElementById('adminPanel').style.display = 'block';
          document.getElementById('adminToggle').classList.add('active');
          updateAkunList();
        } else {
          alert("Password salah");
        }
      } else {
        isAdmin = false;
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('adminToggle').classList.remove('active');
      }
    };

    document.getElementById('daftarToggle').onclick = () => {
      pendaftaranTerbuka = !pendaftaranTerbuka;
      document.getElementById('daftarToggle').textContent = pendaftaranTerbuka ? '[Tutup Pendaftaran]' : '[Buka Pendaftaran]';
      alert(pendaftaranTerbuka ? 'Pendaftaran dibuka!' : 'Pendaftaran ditutup!');
    };

    function buatAkun() {
      if (!pendaftaranTerbuka) return alert("Pendaftaran sedang ditutup oleh admin.");
      if (akun) return alert("Anda sudah memiliki akun.");
      const nama = document.getElementById('namaInput').value.trim();
      if (!nama) return alert("Nama tidak boleh kosong.");
      akun = { nama, saldo: 0, log: [] };
      dataAkun.push(akun);
      document.getElementById('buatAkunPanel').style.display = 'none';
      document.getElementById('akunPanel').style.display = 'block';
      document.getElementById('namaPengguna').textContent = akun.nama;
      updateSaldo();
      updateLog();
    }

    function tambahUang() {
      const jumlah = parseInt(document.getElementById('jumlahUang').value);
      if (isNaN(jumlah) || jumlah <= 0) return;
      akun.saldo += jumlah;
      addLog(`Menambahkan ${formatUang(jumlah)}rb`);
      updateSaldo();
    }

    function ambilUang() {
      const jumlah = parseInt(document.getElementById('jumlahUang').value);
      if (isNaN(jumlah) || jumlah <= 0 || jumlah > akun.saldo) return;
      akun.saldo -= jumlah;
      addLog(`Mengambil ${formatUang(jumlah)}rb`);
      updateSaldo();
    }

    function resetUang() {
      akun.saldo = 0;
      addLog("Saldo disetor dan direset.");
      updateSaldo();
    }

    function addLog(teks) {
      akun.log.unshift(teks);
      if (akun.log.length > 5) akun.log.pop();
      updateLog();
    }

    function updateSaldo() {
      document.getElementById('saldoPengguna').textContent = formatUang(akun.saldo);
    }

    function updateLog() {
      document.getElementById('riwayatLog').innerHTML = akun.log.map(x => `<div>${x}</div>`).join('');
    }

    function formatUang(jumlah) {
      return jumlah.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    function kirimChat() {
      const teks = document.getElementById('chatInput').value.trim();
      if (!teks) return;
      const isi = akun ? `${akun.nama}: ${teks}` : `Anonim: ${teks}`;
      chatList.push(isi);
      if (chatList.length > 20) chatList.shift();
      updateChat();
    }

    function updateChat() {
      document.getElementById('chatBox').innerHTML = chatList.map(c => `<div>${c}</div>`).join('');
    }

    function updateAkunList() {
      document.getElementById('akunList').innerHTML = dataAkun.map((a, i) => `
        <div><b>${a.nama}</b> - ${formatUang(a.saldo)}rb
          <button onclick="ubahNama(${i})">Ubah</button>
          <button onclick="hapusAkun(${i})">Hapus</button>
        </div>
      `).join('');
    }

    function ubahNama(index) {
      const namaBaru = prompt("Masukkan nama baru:", dataAkun[index].nama);
      if (namaBaru) {
        dataAkun[index].nama = namaBaru;
        updateAkunList();
      }
    }

    function hapusAkun(index) {
      if (confirm("Yakin ingin menghapus akun ini?")) {
        if (dataAkun[index] === akun) akun = null;
        dataAkun.splice(index, 1);
        document.getElementById('akunPanel').style.display = 'none';
        document.getElementById('buatAkunPanel').style.display = pendaftaranTerbuka ? 'block' : 'none';
        updateAkunList();
      }
    }
  </script></body>
</html>
