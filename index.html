<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UANGDUTY</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; color: #333; }
    header { background: #333; color: #fff; padding: 10px; position: relative; }
    h1 { margin: 0; font-size: 1.5rem; }
    .admin-btn { position: absolute; top: 10px; left: 10px; background: red; color: #fff; border: none; padding: 5px 10px; cursor: pointer; }
    .admin-btn.active { background: green; }
    main { padding: 20px; max-width: 600px; margin: auto; background: #fff; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .section { margin-bottom: 20px; }
    .section h2 { font-size: 1.2rem; }
    button { padding: 6px 10px; margin: 2px; }
    input[type="text"], input[type="number"] { padding: 6px; margin: 2px; width: 100%; box-sizing: border-box; }
    .chat { border: 1px solid #ccc; height: 150px; overflow-y: auto; margin-bottom: 10px; padding: 5px; background: #f9f9f9; }
    .chat input { width: 80%; }
    .chat button { width: 18%; }
  </style>
</head>
<body>
  <header>
    <button class="admin-btn" onclick="toggleAdmin()" id="adminToggle">Admin Mode</button>
    <h1 style="text-align: center;">UANGDUTY</h1>
  </header>
  <main>
    <div id="adminPasswordPrompt" style="display:none;">
      <input type="password" id="adminPass" placeholder="Masukkan password admin">
      <button onclick="activateAdmin()">Masuk</button>
    </div><div class="section" id="accountSection">
  <h2>Akun</h2>
  <input type="text" id="username" placeholder="Masukkan nama akun">
  <button onclick="createAccount()">Buat Akun</button>
  <p id="accountInfo"></p>
</div>

<div class="section" id="balanceSection" style="display:none;">
  <h2>Saldo: <span id="saldo" style="color:green">0</span>rb</h2>
  <input type="number" id="amountInput" placeholder="Jumlah">
  <button onclick="tambahUang()">Tambah</button>
  <button onclick="ambilUang()">Ambil</button>
  <button onclick="resetUang()">Setor (Reset)</button>
</div>

<div class="section" id="historySection" style="display:none;">
  <h2>Riwayat</h2>
  <ul id="historyList"></ul>
</div>

<div class="section">
  <h2>Forum Chat</h2>
  <div class="chat" id="chatBox"></div>
  <input type="text" id="chatInput" placeholder="Ketik pesan">
  <button onclick="kirimChat()">Kirim</button>
</div>

<div class="section" id="adminPanel" style="display:none;">
  <h2>Panel Admin</h2>
  <button onclick="toggleAccountCreation()" id="toggleAccount">Tutup Pembuatan Akun</button>
  <div id="adminInfo"></div>
</div>

  </main>  <script>
    let isAdmin = false;
    let akun = localStorage.getItem('akun') || null;
    let saldo = parseInt(localStorage.getItem('saldo') || '0');
    let riwayat = JSON.parse(localStorage.getItem('riwayat') || '[]');
    let chatLog = JSON.parse(localStorage.getItem('chatLog') || '[]');
    let accountCreationEnabled = JSON.parse(localStorage.getItem('accountCreationEnabled') || 'true');

    document.addEventListener('DOMContentLoaded', () => {
      updateView();
      updateChat();
    });

    function updateView() {
      document.getElementById('adminToggle').classList.toggle('active', isAdmin);
      document.getElementById('adminPanel').style.display = isAdmin ? 'block' : 'none';
      document.getElementById('balanceSection').style.display = akun ? 'block' : 'none';
      document.getElementById('historySection').style.display = akun ? 'block' : 'none';
      document.getElementById('accountSection').style.display = akun ? 'none' : 'block';
      document.getElementById('accountInfo').innerText = !accountCreationEnabled ? 'Pembuatan akun ditutup oleh Admin.' : '';
      document.getElementById('saldo').innerText = saldo.toLocaleString('id-ID');
      document.getElementById('historyList').innerHTML = riwayat.map(i => `<li>${i}</li>`).join('');
    }

    function toggleAdmin() {
      document.getElementById('adminPasswordPrompt').style.display = 'block';
    }

    function activateAdmin() {
      const pass = document.getElementById('adminPass').value;
      if (pass === 'RFD1') {
        isAdmin = true;
        updateView();
        document.getElementById('adminPasswordPrompt').style.display = 'none';
      } else {
        alert('Password salah');
      }
    }

    function toggleAccountCreation() {
      accountCreationEnabled = !accountCreationEnabled;
      document.getElementById('toggleAccount').innerText = accountCreationEnabled ? 'Tutup Pembuatan Akun' : 'Buka Pembuatan Akun';
      localStorage.setItem('accountCreationEnabled', JSON.stringify(accountCreationEnabled));
      updateView();
    }

    function createAccount() {
      if (!accountCreationEnabled) return alert('Pembuatan akun sedang ditutup.');
      if (akun) return alert('Akun sudah dibuat.');
      const name = document.getElementById('username').value;
      if (!name) return alert('Nama tidak boleh kosong.');
      akun = name;
      localStorage.setItem('akun', akun);
      updateView();
    }

    function tambahUang() {
      const jumlah = parseInt(document.getElementById('amountInput').value);
      if (isNaN(jumlah) || jumlah <= 0) return;
      saldo += jumlah;
      pushHistory(`Menambah ${jumlah.toLocaleString('id-ID')}rb`);
      simpan();
    }

    function ambilUang() {
      const jumlah = parseInt(document.getElementById('amountInput').value);
      if (isNaN(jumlah) || jumlah <= 0) return;
      if (jumlah > saldo) return alert('Saldo tidak cukup.');
      saldo -= jumlah;
      pushHistory(`Mengambil ${jumlah.toLocaleString('id-ID')}rb`);
      simpan();
    }

    function resetUang() {
      saldo = 0;
      pushHistory('Menyetor semua uang (reset saldo)');
      simpan();
    }

    function pushHistory(teks) {
      riwayat.unshift(`${new Date().toLocaleTimeString()} - ${teks}`);
      if (riwayat.length > 5) riwayat.pop();
    }

    function simpan() {
      localStorage.setItem('saldo', saldo);
      localStorage.setItem('riwayat', JSON.stringify(riwayat));
      updateView();
    }

    function kirimChat() {
      const isi = document.getElementById('chatInput').value;
      if (!isi) return;
      chatLog.push(`${akun || 'Anon'}: ${isi}`);
      if (chatLog.length > 50) chatLog.shift();
      localStorage.setItem('chatLog', JSON.stringify(chatLog));
      document.getElementById('chatInput').value = '';
      updateChat();
    }

    function updateChat() {
      const box = document.getElementById('chatBox');
      box.innerHTML = chatLog.map(msg => `<div>${msg}</div>`).join('');
      box.scrollTop = box.scrollHeight;
    }
  </script></body>
</html>
